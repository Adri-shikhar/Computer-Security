<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Security Operations Center - Registration</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/@faker-js/faker@8.3.1/dist/faker.min.js"></script>
    <style>
        :root {
            --primary: #2563eb;
            --primary-dark: #1e40af;
            --accent: #0891b2;
            --success: #059669;
            --danger: #dc2626;
            --warning: #d97706;
            --bg-primary: #ffffff;
            --bg-secondary: #f8fafc;
            --text-primary: #0f172a;
            --text-secondary: #475569;
            --text-muted: #64748b;
            --border-subtle: #e2e8f0;
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.08);
            --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Inter', 'Segoe UI', system-ui, sans-serif;
            background: var(--bg-secondary);
            min-height: 100vh;
            display: flex;
        }

        /* Left Sidebar */
        .sidebar {
            width: 280px;
            background: var(--bg-primary);
            border-right: 1px solid var(--border-subtle);
            height: 100vh;
            position: fixed;
            left: 0;
            top: 0;
            overflow-y: auto;
            z-index: 1000;
            box-shadow: var(--shadow-sm);
        }


        .sidebar-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--border-subtle);
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
        }

        .sidebar-header h4 {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-weight: 700;
            margin-bottom: 0.25rem;
        }

        .sidebar-header p {
            font-size: 0.75rem;
            opacity: 0.9;
            margin: 0;
        }

        .nav-section { padding: 1rem 0; }

        .nav-section-title {
            padding: 0.5rem 1.5rem;
            font-size: 0.7rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--text-muted);
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1.5rem;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 0.875rem;
            font-weight: 500;
            transition: all 0.2s ease;
            border-left: 3px solid transparent;
        }

        .nav-item:hover {
            background: var(--bg-secondary);
            color: var(--primary);
            border-left-color: var(--primary);
        }

        .nav-item.active {
            background: linear-gradient(90deg, rgba(37, 99, 235, 0.1) 0%, transparent 100%);
            color: var(--primary);
            border-left-color: var(--primary);
            font-weight: 600;
        }

        .nav-item i { width: 20px; text-align: center; }

        .sub-nav {
            background: var(--bg-secondary);
            border-left: 2px solid var(--border-subtle);
            margin-left: 2.5rem;
            margin-right: 1rem;
            border-radius: 0 8px 8px 0;
            overflow: hidden;
            display: none;
        }

        .sub-nav.show { display: block; }

        .sub-nav-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            color: var(--text-muted);
            text-decoration: none;
            font-size: 0.8rem;
            transition: all 0.2s ease;
        }

        .sub-nav-item:hover {
            color: var(--primary);
            background: var(--bg-primary);
        }

        .nav-toggle {
            margin-left: auto;
            font-size: 0.7rem;
            transition: transform 0.2s ease;
        }

        .nav-toggle.open { transform: rotate(180deg); }

        /* Main Content */
        .main-content {
            margin-left: 280px;
            flex: 1;
            min-height: 100vh;
        }

        .top-bar {
            background: var(--bg-primary);
            padding: 1rem 2rem;
            border-bottom: 1px solid var(--border-subtle);
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .content-area { padding: 2rem; }

        /* Login/Registration Panel */
        .auth-container {
            max-width: 450px;
            margin: 0 auto;
            padding-top: 2rem;
        }

        .auth-card {
            background: var(--bg-primary);
            border-radius: 20px;
            box-shadow: var(--shadow-md);
            overflow: hidden;
        }

        .auth-header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            padding: 2rem;
            text-align: center;
            color: white;
        }

        .auth-header i {
            font-size: 3rem;
            margin-bottom: 1rem;
            opacity: 0.9;
        }

        .auth-header h2 {
            font-size: 1.5rem;
            font-weight: 700;
            margin: 0;
        }

        .auth-header p {
            font-size: 0.875rem;
            opacity: 0.9;
            margin: 0.5rem 0 0;
        }

        .auth-body { padding: 2rem; }

        .form-group { margin-bottom: 1.25rem; }

        .form-label {
            display: block;
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }

        .form-control {
            width: 100%;
            padding: 0.875rem 1rem;
            border: 2px solid var(--border-subtle);
            border-radius: 10px;
            font-size: 0.875rem;
            background: var(--bg-primary);
            color: var(--text-primary);
            transition: all 0.2s ease;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(37, 99, 235, 0.1);
        }
        
        .form-control:invalid:not(:placeholder-shown) {
            border-color: var(--danger);
        }
        
        .form-control:valid:not(:placeholder-shown) {
            border-color: var(--success);
        }

        .btn {
            padding: 0.875rem 1.5rem;
            border-radius: 10px;
            font-size: 0.875rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            border: none;
            width: 100%;
        }

        .btn-primary { background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%); color: white; }
        .btn-success { background: linear-gradient(135deg, var(--success) 0%, #047857 100%); color: white; }

        .btn:hover { transform: translateY(-2px); box-shadow: var(--shadow-md); }

        .alert {
            padding: 1rem;
            border-radius: 10px;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .alert-success { background: #d1fae5; color: #047857; border: 1px solid #6ee7b7; }
        .alert-danger { background: #fee2e2; color: #b91c1c; border: 1px solid #fca5a5; }

        /* Mobile Toggle */
        .mobile-toggle {
            display: none;
            position: fixed;
            top: 1rem;
            left: 1rem;
            z-index: 1100;
            background: var(--primary);
            color: white;
            border: none;
            width: 45px;
            height: 45px;
            border-radius: 10px;
            cursor: pointer;
        }

        @media (max-width: 992px) {
            .sidebar { transform: translateX(-100%); }
            .sidebar.show { transform: translateX(0); }
            .main-content { margin-left: 0; }
            .mobile-toggle { display: flex; align-items: center; justify-content: center; }
        }

        /* Quick Access */
        .quick-access {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1rem;
            margin-top: 2rem;
        }

        .quick-card {
            background: var(--bg-primary);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 1.25rem;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 1rem;
            transition: all 0.2s ease;
        }

        .quick-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-md);
        }

        .quick-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
        }

        .quick-card h5 { margin: 0 0 0.25rem; color: var(--text-primary); font-size: 1rem; }
        .quick-card p { margin: 0; font-size: 0.8rem; color: var(--text-muted); }
    </style>
</head>
<body>
    <!-- Mobile Toggle -->
    <button class="mobile-toggle" onclick="toggleSidebar()">
        <i class="fas fa-bars"></i>
    </button>

    <!-- Left Sidebar -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <h4><i class="fas fa-shield-halved"></i> SOC Platform</h4>
            <p>Security Operations Center</p>
        </div>

        <nav class="nav-section">
            <div class="nav-section-title">Main Navigation</div>
            <a href="index.html" class="nav-item active">
                <i class="fas fa-user-plus"></i> Registration
            </a>
            <a href="backend/dashboard.html" class="nav-item">
                <i class="fas fa-database"></i> Backend Dashboard
            </a>
        </nav>

        <nav class="nav-section">
            <div class="nav-section-title">Dashboard Features</div>
            
            <a href="dashboard-features/duplicate-checker/duplicate-checker.html" class="nav-item">
                <i class="fas fa-copy"></i> Duplicate Password Checker
            </a>

            <a href="dashboard-features/breach-checker/breach-checker.html" class="nav-item">
                <i class="fas fa-user-lock"></i> Breach Checker
            </a>

            <a href="dashboard-features/resalt-management/resalt-management.html" class="nav-item">
                <i class="fas fa-shield-alt"></i> Re-salt Management
            </a>

            <a href="dashboard-features/security-analytics/security-analytics.html" class="nav-item">
                <i class="fas fa-chart-line"></i> Security Analytics
            </a>

            <a href="dashboard-features/password-generator/password-generator.html" class="nav-item">
                <i class="fas fa-key"></i> Password Generator
            </a>
        </nav>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <div class="top-bar">
            <div style="display: flex; align-items: center; gap: 1rem;">
                <i class="fas fa-shield-halved" style="font-size: 1.5rem; color: var(--primary);"></i>
                <div>
                    <h3 style="margin: 0; font-size: 1.1rem; color: var(--text-primary);">Security Operations Center</h3>
                    <p style="margin: 0; font-size: 0.8rem; color: var(--text-muted);">Computer Security Lab</p>
                </div>
            </div>
            <span style="background: #d1fae5; color: #059669; padding: 0.5rem 1rem; border-radius: 50px; font-size: 0.8rem; font-weight: 600;">
                <i class="fas fa-shield-check"></i> System Secure
            </span>
        </div>

        <div class="content-area">
            <!-- REGISTRATION SECTION -->
            <div class="auth-container">
                <div class="auth-card">
                    <div class="auth-header">
                        <i class="fas fa-user-shield"></i>
                        <h2>User Registration</h2>
                        <p>Secure Authentication System</p>
                    </div>
                    <div class="auth-body">
                        <div id="alertArea"></div>
                        
                        <form id="registerForm" onsubmit="registerUser(event)">
                            <div class="form-group">
                                <label class="form-label"><i class="fas fa-user"></i> Full Name</label>
                                <input type="text" class="form-control" id="fullName" placeholder="e.g., John Smith" required autocomplete="name" autofocus>
                            </div>
                            <div class="form-group">
                                <label class="form-label"><i class="fas fa-envelope"></i> Email Address</label>
                                <input type="email" class="form-control" id="email" placeholder="e.g., john.smith@example.com" required autocomplete="email">
                            </div>
                            <div class="form-group">
                                <label class="form-label">
                                    <i class="fas fa-lock"></i> Password
                                    <small style="font-weight: 400; color: var(--text-muted);">(minimum 8 characters)</small>
                                </label>
                                <div style="position: relative;">
                                    <input type="password" class="form-control" id="password" placeholder="Enter a strong password (min. 8 characters)" required minlength="8" autocomplete="new-password" oninput="analyzePassword()">
                                    <button type="button" onclick="togglePasswordVisibility('password', 'togglePassIcon')" style="position: absolute; right: 12px; top: 50%; transform: translateY(-50%); background: none; border: none; cursor: pointer; color: var(--text-muted);" title="Show/Hide Password">
                                        <i class="fas fa-eye" id="togglePassIcon"></i>
                                    </button>
                                </div>
                                
                                <!-- Security Meter -->
                                <div id="securityMeter" style="display: none; margin-top: 0.75rem;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.25rem;">
                                        <span style="font-size: 0.75rem; font-weight: 600;" id="securityLabel">Security Score: 0/100</span>
                                        <span style="font-size: 0.7rem;" id="breachStatus"></span>
                                    </div>
                                    <div style="height: 8px; background: #e2e8f0; border-radius: 10px; overflow: hidden;">
                                        <div id="securityBar" style="height: 100%; width: 0%; background: linear-gradient(90deg, #ef4444, #f59e0b, #10b981); transition: width 0.3s ease;"></div>
                                    </div>
                                </div>
                                
                                <small style="font-size: 0.75rem; color: var(--text-muted); display: block; margin-top: 0.5rem;">
                                    <i class="fas fa-lightbulb"></i> Use our <a href="dashboard-features/password-generator/password-generator.html" style="color: var(--primary); font-weight: 600;">Password Generator</a> for secure passwords
                                </small>
                            </div>
                            <div class="d-flex gap-2" style="display: flex; gap: 0.5rem;">
                                <button type="submit" class="btn btn-primary" id="registerBtn" style="flex: 1;">
                                    <i class="fas fa-user-plus"></i> Register Account
                                </button>
                                <button type="button" class="btn btn-success" onclick="generateStrongPassword()" title="Generate a strong password" style="white-space: nowrap;">
                                    <i class="fas fa-magic"></i> Auto-Generate
                                </button>
                                <button type="button" class="btn btn-outline-primary" onclick="loadExample()" title="See how it works with example data">
                                    <i class="fas fa-flask"></i> Try Example
                                </button>
                            </div>
                        </form>

                        <!-- Multi-Hash Preview Panel -->
                        <div id="hashPreview" style="display: none; margin-top: 1.5rem; padding: 1.25rem; background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%); border-radius: 12px; border: 2px solid #dbeafe; box-shadow: 0 2px 8px rgba(37, 99, 235, 0.1);">
                            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 1rem;">
                                <h6 style="margin: 0; font-size: 0.875rem; font-weight: 700; color: var(--text-primary);">
                                    <i class="fas fa-fingerprint" style="color: var(--primary);"></i> Multi-Hash Comparison
                                </h6>
                                <div style="display: flex; gap: 0.5rem; align-items: center;">
                                    <span style="font-size: 0.7rem; color: var(--text-muted);">
                                        <i class="fas fa-bolt"></i> <span id="totalHashTime">0.00</span>ms
                                    </span>
                                    <button type="button" onclick="copyAllHashes()" style="background: var(--primary); color: white; border: none; padding: 0.25rem 0.5rem; border-radius: 6px; cursor: pointer; font-size: 0.7rem;">
                                        <i class="fas fa-copy"></i> Copy All
                                    </button>
                                </div>
                            </div>
                            
                            <div style="display: grid; gap: 0.75rem;">
                                <div class="hash-row">
                                    <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.25rem;">
                                        <span style="font-size: 0.7rem; font-weight: 600; color: #dc2626;">MD5</span>
                                        <span style="font-size: 0.65rem; background: #fecaca; color: #991b1b; padding: 0.125rem 0.375rem; border-radius: 4px;">‚ö†Ô∏è Insecure</span>
                                        <span style="font-size: 0.65rem; color: #64748b; margin-left: auto;"><span id="timeMD5">0.00</span>ms</span>
                                    </div>
                                    <div style="background: #fef2f2; padding: 0.5rem; border-radius: 6px; font-family: 'Courier New', monospace; font-size: 0.7rem; color: #dc2626; word-break: break-all; position: relative; border: 1px solid #fecaca;" id="hashMD5">
                                        <code style="color: inherit;">5f4dcc3b5aa765d61d8327deb882cf99</code>
                                        <button onclick="copyHash('hashMD5')" style="position: absolute; right: 0.5rem; top: 50%; transform: translateY(-50%); background: white; border: 1px solid #fecaca; padding: 0.25rem 0.5rem; border-radius: 4px; cursor: pointer; font-size: 0.65rem;">
                                            <i class="fas fa-copy"></i>
                                        </button>
                                    </div>
                                </div>
                                
                                <div class="hash-row">
                                    <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.25rem;">
                                        <span style="font-size: 0.7rem; font-weight: 600; color: #d97706;">SHA-1</span>
                                        <span style="font-size: 0.65rem; background: #fef3c7; color: #92400e; padding: 0.125rem 0.375rem; border-radius: 4px;">‚ö†Ô∏è Deprecated</span>
                                        <span style="font-size: 0.65rem; color: #64748b; margin-left: auto;"><span id="timeSHA1">0.00</span>ms</span>
                                    </div>
                                    <div style="background: #fffbeb; padding: 0.5rem; border-radius: 6px; font-family: 'Courier New', monospace; font-size: 0.7rem; color: #d97706; word-break: break-all; position: relative; border: 1px solid #fef3c7;" id="hashSHA1">
                                        <code style="color: inherit;">5baa61e4c9b93f3f0682250b6cf8331b7ee68fd8</code>
                                        <button onclick="copyHash('hashSHA1')" style="position: absolute; right: 0.5rem; top: 50%; transform: translateY(-50%); background: white; border: 1px solid #fef3c7; padding: 0.25rem 0.5rem; border-radius: 4px; cursor: pointer; font-size: 0.65rem;">
                                            <i class="fas fa-copy"></i>
                                        </button>
                                    </div>
                                </div>
                                
                                <div class="hash-row">
                                    <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.25rem;">
                                        <span style="font-size: 0.7rem; font-weight: 600; color: #2563eb;">SHA-256</span>
                                        <span style="font-size: 0.65rem; background: #dbeafe; color: #1e40af; padding: 0.125rem 0.375rem; border-radius: 4px;">‚úì Recommended</span>
                                        <span style="font-size: 0.65rem; color: #64748b; margin-left: auto;"><span id="timeSHA256">0.00</span>ms</span>
                                    </div>
                                    <div style="background: #eff6ff; padding: 0.5rem; border-radius: 6px; font-family: 'Courier New', monospace; font-size: 0.7rem; color: #2563eb; word-break: break-all; position: relative; border: 1px solid #dbeafe;" id="hashSHA256">
                                        <code style="color: inherit;">5e884898da28047151d0e56f8dc6292773603d0d6aabbdd62a11ef721d1542d8</code>
                                        <button onclick="copyHash('hashSHA256')" style="position: absolute; right: 0.5rem; top: 50%; transform: translateY(-50%); background: white; border: 1px solid #dbeafe; padding: 0.25rem 0.5rem; border-radius: 4px; cursor: pointer; font-size: 0.65rem;">
                                            <i class="fas fa-copy"></i>
                                        </button>
                                    </div>
                                </div>
                                
                                <div class="hash-row">
                                    <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.25rem;">
                                        <span style="font-size: 0.7rem; font-weight: 600; color: #059669;">SHA-512</span>
                                        <span style="font-size: 0.65rem; background: #d1fae5; color: #047857; padding: 0.125rem 0.375rem; border-radius: 4px;">‚úì Most Secure</span>
                                        <span style="font-size: 0.65rem; color: #64748b; margin-left: auto;"><span id="timeSHA512">0.00</span>ms</span>
                                    </div>
                                    <div style="background: #f0fdf4; padding: 0.5rem; border-radius: 6px; font-family: 'Courier New', monospace; font-size: 0.7rem; color: #059669; word-break: break-all; position: relative; border: 1px solid #d1fae5;" id="hashSHA512">
                                        <code style="color: inherit;">b109f3bbbc244eb82441917ed06d618b9008dd09b3befd1b5e07394c706a8bb980b1d7785e5976ec049b46df5f1326af5a2ea6d103fd07c95385ffab0cacbc86</code>
                                        <button onclick="copyHash('hashSHA512')" style="position: absolute; right: 0.5rem; top: 50%; transform: translateY(-50%); background: white; border: 1px solid #d1fae5; padding: 0.25rem 0.5rem; border-radius: 4px; cursor: pointer; font-size: 0.65rem;">
                                            <i class="fas fa-copy"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <div style="margin-top: 1rem; padding: 1rem; background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%); border-radius: 8px; border-left: 4px solid var(--primary);">
                                <div style="font-size: 0.75rem; color: var(--text-primary);">
                                    <strong><i class="fas fa-lightbulb"></i> Why Multiple Hashes?</strong><br>
                                    <span style="color: var(--text-muted); font-size: 0.7rem;">
                                        Each algorithm offers different security levels. SHA-256 and SHA-512 are recommended for modern applications.
                                        MD5 and SHA-1 are shown for educational comparison only.
                                    </span>
                                </div>
                            </div>
                        </div>
                        
                        <div style="margin-top: 1.5rem; padding: 1rem; background: var(--bg-secondary); border-radius: 10px; text-align: center;">
                            <p style="font-size: 0.8rem; color: var(--text-muted); margin: 0;">
                                <i class="fas fa-shield-alt"></i> Password will be hashed using <strong>4 algorithms</strong> (MD5, SHA-1, SHA-256, SHA-512).<br>
                                View registered data in <a href="backend/dashboard.html" style="color: var(--success); font-weight: 600;">Backend Dashboard</a> (switch to Backend mode).
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Quick Access -->
                <div class="quick-access">
                    <a href="backend/dashboard.html" class="quick-card">
                        <div class="quick-icon" style="background: #d1fae5; color: var(--success);">
                            <i class="fas fa-database"></i>
                        </div>
                        <div>
                            <h5>Backend Dashboard</h5>
                            <p>View all registered users</p>
                        </div>
                    </a>
                    <a href="dashboard-features/password-generator/password-generator.html" class="quick-card">
                        <div class="quick-icon" style="background: #dbeafe; color: var(--primary);">
                            <i class="fas fa-key"></i>
                        </div>
                        <div>
                            <h5>Password Generator</h5>
                            <p>Generate secure passwords</p>
                        </div>
                    </a>
                </div>
            </div>
        </div>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <script src="shared/js/live-demo-service.js"></script>
    <script src="shared/js/api-client.js"></script>
    <script>
        // API Base URL - change this when deploying
        const API_BASE = 'http://localhost:5000/api';
        
        // Toggle sidebar for mobile
        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('show');
        }

        // Toggle password visibility
        function togglePasswordVisibility(inputId, iconId) {
            const input = document.getElementById(inputId);
            const icon = document.getElementById(iconId);
            if (input.type === 'password') {
                input.type = 'text';
                icon.classList.remove('fa-eye');
                icon.classList.add('fa-eye-slash');
            } else {
                input.type = 'password';
                icon.classList.remove('fa-eye-slash');
                icon.classList.add('fa-eye');
            }
        }

        // Toggle sub-navigation
        function toggleSubNav(id, event) {
            event.preventDefault();
            event.stopPropagation();
            const subNav = document.getElementById(id);
            const toggle = event.currentTarget.querySelector('.nav-toggle');
            
            document.querySelectorAll('.sub-nav').forEach(nav => {
                if (nav.id !== id) {
                    nav.classList.remove('show');
                    nav.previousElementSibling.querySelector('.nav-toggle')?.classList.remove('open');
                }
            });
            
            subNav.classList.toggle('show');
            toggle?.classList.toggle('open');
        }

        // Generate strong password automatically
        function generateStrongPassword() {
            const chars = 'ABCDEFGHJKLMNPQRSTUVWXYZabcdefghjkmnpqrstuvwxyz23456789!@#$%^&*';
            const array = new Uint8Array(16);
            crypto.getRandomValues(array);
            let password = '';
            for (let i = 0; i < 16; i++) {
                password += chars[array[i] % chars.length];
            }
            document.getElementById('password').value = password;
            document.getElementById('password').type = 'text';
            document.getElementById('togglePassIcon').classList.remove('fa-eye');
            document.getElementById('togglePassIcon').classList.add('fa-eye-slash');
            analyzePassword();
            showAlert('‚ú® Strong password generated! <strong>Save it securely!</strong>', 'success');
        }

        // Password analysis with security score and breach detection
        let currentPasswordData = null;
        
        function loadExample() {
            // Load example data
            document.getElementById('fullName').value = 'John Doe';
            document.getElementById('email').value = 'john.doe@example.com';
            document.getElementById('password').value = 'password';
            document.getElementById('password').type = 'text';
            document.getElementById('togglePassIcon').classList.remove('fa-eye');
            document.getElementById('togglePassIcon').classList.add('fa-eye-slash');
            
            // Trigger analysis
            analyzePassword();
            
            showAlert('üìò Example loaded! This shows how "password" is hashed with different algorithms. Try a stronger password!', 'primary');
        }
        
        function copyHash(elementId) {
            const element = document.getElementById(elementId);
            const text = element.querySelector('code').textContent;
            navigator.clipboard.writeText(text).then(() => {
                showAlert('‚úì Hash copied to clipboard!', 'success');
            });
        }
        
        function copyAllHashes() {
            if (!currentPasswordData) return;
            
            const text = `MD5: ${currentPasswordData.md5}\nSHA-1: ${currentPasswordData.sha1}\nSHA-256: ${currentPasswordData.sha256}\nSHA-512: ${currentPasswordData.sha512}`;
            navigator.clipboard.writeText(text).then(() => {
                showAlert('‚úì All hashes copied to clipboard!', 'success');
            });
        }
        
        function analyzePassword() {
            const password = document.getElementById('password').value;
            const meter = document.getElementById('securityMeter');
            const hashPreview = document.getElementById('hashPreview');
            
            if (!password) {
                meter.style.display = 'none';
                hashPreview.style.display = 'none';
                currentPasswordData = null;
                return;
            }
            
            meter.style.display = 'block';
            hashPreview.style.display = 'block';
            
            // Calculate security score
            const score = calculateSecurityScore(password);
            updateSecurityMeter(score);
            
            // Generate all hashes with timing
            const hashData = generateMultiHash(password);
            currentPasswordData = hashData;
            
            // Update hash preview with cleaner display
            document.getElementById('hashMD5').querySelector('code').textContent = hashData.md5;
            document.getElementById('hashSHA1').querySelector('code').textContent = hashData.sha1;
            document.getElementById('hashSHA256').querySelector('code').textContent = hashData.sha256;
            document.getElementById('hashSHA512').querySelector('code').textContent = hashData.sha512;
            
            // Update individual timings
            document.getElementById('timeMD5').textContent = hashData.timings.md5;
            document.getElementById('timeSHA1').textContent = hashData.timings.sha1;
            document.getElementById('timeSHA256').textContent = hashData.timings.sha256;
            document.getElementById('timeSHA512').textContent = hashData.timings.sha512;
            
            // Calculate total time
            const totalTime = (parseFloat(hashData.timings.md5) + parseFloat(hashData.timings.sha1) + 
                              parseFloat(hashData.timings.sha256) + parseFloat(hashData.timings.sha512)).toFixed(2);
            document.getElementById('totalHashTime').textContent = totalTime;
            
            // Check for common breaches (simulated)
            checkPasswordBreach(password, hashData.sha1);
        }
        
        function calculateSecurityScore(password) {
            let score = 0;
            
            // Length score (0-40 points)
            if (password.length >= 8) score += 20;
            if (password.length >= 12) score += 10;
            if (password.length >= 16) score += 10;
            
            // Character variety (0-40 points)
            if (/[a-z]/.test(password)) score += 10;
            if (/[A-Z]/.test(password)) score += 10;
            if (/[0-9]/.test(password)) score += 10;
            if (/[^a-zA-Z0-9]/.test(password)) score += 10;
            
            // Complexity bonus (0-20 points)
            const uniqueChars = new Set(password).size;
            score += Math.min(20, Math.floor(uniqueChars * 2));
            
            // Penalties
            if (/(.)\1{2,}/.test(password)) score -= 10; // Repeated chars
            if (/^[0-9]+$/.test(password)) score -= 20; // Only numbers
            if (/^(password|123456|qwerty)/i.test(password)) score -= 30; // Common patterns
            
            return Math.max(0, Math.min(100, score));
        }
        
        function updateSecurityMeter(score) {
            const bar = document.getElementById('securityBar');
            const label = document.getElementById('securityLabel');
            
            bar.style.width = score + '%';
            label.textContent = `Security Score: ${score}/100`;
            
            // Color coding
            if (score < 40) {
                label.style.color = '#dc2626';
            } else if (score < 70) {
                label.style.color = '#d97706';
            } else {
                label.style.color = '#059669';
            }
        }
        
        function generateMultiHash(password) {
            const timings = {};
            
            // MD5
            let start = performance.now();
            const md5 = CryptoJS.MD5(password).toString();
            timings.md5 = (performance.now() - start).toFixed(2);
            
            // SHA-1
            start = performance.now();
            const sha1 = CryptoJS.SHA1(password).toString();
            timings.sha1 = (performance.now() - start).toFixed(2);
            
            // SHA-256
            start = performance.now();
            const sha256 = CryptoJS.SHA256(password).toString();
            timings.sha256 = (performance.now() - start).toFixed(2);
            
            // SHA-512
            start = performance.now();
            const sha512 = CryptoJS.SHA512(password).toString();
            timings.sha512 = (performance.now() - start).toFixed(2);
            
            return { md5, sha1, sha256, sha512, timings };
        }
        
        function checkPasswordBreach(password, sha1Hash) {
            const breachStatus = document.getElementById('breachStatus');
            
            // Common breached passwords (simulated check)
            const commonPasswords = [
                '123456', 'password', '123456789', '12345678', '12345',
                'qwerty', 'abc123', '111111', 'password1', 'admin', 'letmein'
            ];
            
            if (commonPasswords.includes(password.toLowerCase())) {
                breachStatus.innerHTML = '<span style="background: #fecaca; color: #991b1b; padding: 0.25rem 0.5rem; border-radius: 6px; font-weight: 600;"><i class="fas fa-exclamation-triangle"></i> BREACHED</span>';
            } else if (password.length < 12) {
                breachStatus.innerHTML = '<span style="background: #fef3c7; color: #92400e; padding: 0.25rem 0.5rem; border-radius: 6px; font-weight: 600;"><i class="fas fa-shield-alt"></i> WEAK</span>';
            } else {
                breachStatus.innerHTML = '<span style="background: #d1fae5; color: #047857; padding: 0.25rem 0.5rem; border-radius: 6px; font-weight: 600;"><i class="fas fa-check-circle"></i> SECURE</span>';
            }
        }
        
        function copyHash(elementId) {
            const element = document.getElementById(elementId);
            const text = element.querySelector('code').textContent;
            navigator.clipboard.writeText(text).then(() => {
                showAlert('‚úì Hash copied to clipboard!', 'success');
            });
        }
        
        function copyAllHashes() {
            if (!currentPasswordData) return;
            
            const text = `MD5: ${currentPasswordData.md5}\nSHA-1: ${currentPasswordData.sha1}\nSHA-256: ${currentPasswordData.sha256}\nSHA-512: ${currentPasswordData.sha512}`;
            navigator.clipboard.writeText(text).then(() => {
                showAlert('‚úì All hashes copied to clipboard!', 'success');
            });
        }
        
        function loadExample() {
            // Load example data
            document.getElementById('fullName').value = 'John Doe';
            document.getElementById('email').value = 'john.doe@example.com';
            document.getElementById('password').value = 'password';
            document.getElementById('password').type = 'text';
            document.getElementById('togglePassIcon').classList.remove('fa-eye');
            document.getElementById('togglePassIcon').classList.add('fa-eye-slash');
            
            // Trigger analysis
            analyzePassword();
            
            showAlert('üìò Example loaded! This shows how "password" is hashed with different algorithms. Try a stronger password!', 'primary');
        }
        
        function toggleHashPreview() {
            const panel = document.getElementById('hashPreview');
            panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
        }

        // Register user with Flask backend (MD5 authentication)
        async function registerUser(event) {
            event.preventDefault();
            
            const name = document.getElementById('fullName').value;
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const algorithm = 'MD5';  // Hardcoded to MD5
            const btn = document.getElementById('registerBtn');
            const originalHTML = btn.innerHTML;
            
            // Generate all hashes for reference (MD5, SHA-1, SHA-256, SHA-512)
            const hashData = currentPasswordData || generateMultiHash(password);
            const securityScore = calculateSecurityScore(password);
            
            // Show loading state
            btn.disabled = true;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Registering...';
            
            try {
                const response = await fetch(API_BASE + '/register', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ 
                        name, 
                        email, 
                        password,
                        algorithm: algorithm,  // Send selected algorithm
                        hashes: {
                            md5: hashData.md5,
                            sha1: hashData.sha1,
                            sha256: hashData.sha256,
                            sha512: hashData.sha512
                        },
                        securityScore: securityScore
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    showAlert(`‚úÖ Registration successful!<br>
                        <small>Security Score: <strong>${securityScore}/100</strong></small><br>
                        View in <a href="backend/dashboard.html" style="color: inherit; font-weight: 700;">Backend Dashboard</a>`, 'success');
                    document.getElementById('registerForm').reset();
                    document.getElementById('fullName').focus();
                    document.getElementById('securityMeter').style.display = 'none';
                    document.getElementById('hashPreview').style.display = 'none';
                    currentPasswordData = null;
                } else {
                    showAlert(data.message, 'danger');
                }
                btn.disabled = false;
                btn.innerHTML = originalHTML;
            } catch (error) {
                showAlert(`‚ö†Ô∏è Cannot connect to Flask backend.<br>
                    <small>Run: <code>.\.venv\Scripts\python.exe backend\app.py</code></small>`, 'danger');
                console.error('Registration error:', error);
                btn.disabled = false;
                btn.innerHTML = originalHTML;
            }
        }

        // Show alert message
        function showAlert(message, type) {
            const alertArea = document.getElementById('alertArea');
            alertArea.innerHTML = `
                <div class="alert alert-${type}">
                    <i class="fas fa-${type === 'success' ? 'check-circle' : 'exclamation-circle'}"></i>
                    ${message}
                </div>
            `;
            setTimeout(() => alertArea.innerHTML = '', 8000);
        }
    </script>
</body>
</html>
