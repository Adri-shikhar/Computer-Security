<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hash Analysis Tools - Security Operations Center</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #2563eb;
            --primary-dark: #1e40af;
            --accent: #0891b2;
            --success: #059669;
            --danger: #dc2626;
            --warning: #d97706;
            --bg-primary: #ffffff;
            --bg-secondary: #f8fafc;
            --bg-sidebar: #f1f5f9;
            --text-primary: #0f172a;
            --text-secondary: #475569;
            --text-muted: #64748b;
            --border-subtle: #e2e8f0;
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.08);
            --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Inter', 'Segoe UI', system-ui, sans-serif;
            background: var(--bg-secondary);
            min-height: 100vh;
            display: flex;
        }

        /* Left Sidebar */
        .sidebar {
            width: 280px;
            background: var(--bg-primary);
            border-right: 1px solid var(--border-subtle);
            height: 100vh;
            position: fixed;
            left: 0;
            top: 0;
            overflow-y: auto;
            z-index: 1000;
            box-shadow: var(--shadow-sm);
        }

        .sidebar-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--border-subtle);
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
        }

        .sidebar-header h4 {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-weight: 700;
            margin-bottom: 0.25rem;
        }

        .sidebar-header h4 a {
            color: white;
            text-decoration: none;
        }

        .sidebar-header p {
            font-size: 0.75rem;
            opacity: 0.9;
            margin: 0;
        }

        .nav-section { padding: 1rem 0; }

        .nav-section-title {
            padding: 0.5rem 1.5rem;
            font-size: 0.7rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--text-muted);
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1.5rem;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 0.875rem;
            font-weight: 500;
            transition: all 0.2s ease;
            border-left: 3px solid transparent;
        }

        .nav-item:hover {
            background: var(--bg-secondary);
            color: var(--primary);
            border-left-color: var(--primary);
        }

        .nav-item.active {
            background: linear-gradient(90deg, rgba(37, 99, 235, 0.1) 0%, transparent 100%);
            color: var(--primary);
            border-left-color: var(--primary);
            font-weight: 600;
        }

        .nav-item i { width: 20px; text-align: center; }

        .sub-nav {
            background: var(--bg-secondary);
            border-left: 2px solid var(--border-subtle);
            margin-left: 2.5rem;
            margin-right: 1rem;
            border-radius: 0 8px 8px 0;
            overflow: hidden;
            display: none;
        }

        .sub-nav.show { display: block; }

        .sub-nav-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            color: var(--text-muted);
            text-decoration: none;
            font-size: 0.8rem;
            transition: all 0.2s ease;
        }

        .sub-nav-item:hover {
            color: var(--primary);
            background: var(--bg-primary);
        }

        .nav-toggle {
            margin-left: auto;
            font-size: 0.7rem;
            transition: transform 0.2s ease;
        }

        .nav-toggle.open { transform: rotate(180deg); }

        /* Main Content */
        .main-content {
            margin-left: 280px;
            flex: 1;
            min-height: 100vh;
        }

        .top-bar {
            background: var(--bg-primary);
            padding: 1rem 2rem;
            border-bottom: 1px solid var(--border-subtle);
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .page-title {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .page-title h2 {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-primary);
            margin: 0;
        }

        .content-area { padding: 2rem; }

        /* Tool Selector */
        .tool-selector {
            background: var(--bg-primary);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .tool-selector label { font-weight: 600; color: var(--text-primary); }

        .tool-selector select {
            flex: 1;
            min-width: 200px;
            padding: 0.75rem 1rem;
            border: 1px solid var(--border-subtle);
            border-radius: 8px;
            font-size: 1rem;
            background: var(--bg-secondary);
            color: var(--text-primary);
        }

        /* Tool Cards */
        .tool-card {
            background: var(--bg-primary);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            margin-bottom: 1.5rem;
            overflow: hidden;
            display: none;
        }

        .tool-card.active { display: block; }

        .tool-card-header {
            background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-primary) 100%);
            padding: 1.25rem 1.5rem;
            border-bottom: 1px solid var(--border-subtle);
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .tool-card-header h3 {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--text-primary);
            margin: 0;
        }

        .tool-card-body { padding: 1.5rem; }

        .form-label {
            display: block;
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }

        .form-control {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 1px solid var(--border-subtle);
            border-radius: 8px;
            font-size: 0.875rem;
            background: var(--bg-primary);
            color: var(--text-primary);
            transition: all 0.2s ease;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            font-size: 0.875rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            border: none;
        }

        .btn-primary { background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%); color: white; }
        .btn-success { background: linear-gradient(135deg, var(--success) 0%, #047857 100%); color: white; }
        .btn-warning { background: linear-gradient(135deg, var(--warning) 0%, #b45309 100%); color: white; }

        .btn:hover { transform: translateY(-2px); box-shadow: var(--shadow-md); }

        .results-area { margin-top: 1.5rem; }

        .alert {
            padding: 1rem 1.25rem;
            border-radius: 10px;
            margin-bottom: 1rem;
        }

        .alert-info { background: #dbeafe; border: 1px solid #93c5fd; color: var(--primary-dark); }
        .alert-success { background: #d1fae5; border: 1px solid #6ee7b7; color: #047857; }
        .alert-warning { background: #fef3c7; border: 1px solid #fcd34d; color: #b45309; }
        .alert-danger { background: #fee2e2; border: 1px solid #fca5a5; color: #b91c1c; }

        .table {
            width: 100%;
            border-collapse: collapse;
        }

        .table th, .table td {
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid var(--border-subtle);
        }

        .table th {
            background: var(--bg-secondary);
            font-weight: 600;
            color: var(--text-primary);
        }

        .table code {
            background: var(--bg-secondary);
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.8rem;
            word-break: break-all;
        }

        .badge {
            padding: 0.25rem 0.75rem;
            border-radius: 50px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .badge-danger { background: #fee2e2; color: var(--danger); }
        .badge-warning { background: #fef3c7; color: var(--warning); }
        .badge-info { background: #dbeafe; color: var(--primary); }
        .badge-success { background: #d1fae5; color: var(--success); }

        .form-check {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
        }

        .form-check-input { width: 1rem; height: 1rem; }

        .progress {
            height: 1.5rem;
            background: var(--bg-secondary);
            border-radius: 8px;
            overflow: hidden;
        }

        .progress-bar {
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: 600;
            color: white;
        }

        .bg-success { background: var(--success) !important; }
        .bg-warning { background: var(--warning) !important; }
        .bg-danger { background: var(--danger) !important; }
        .bg-info { background: var(--primary) !important; }

        /* Mobile Toggle */
        .mobile-toggle {
            display: none;
            position: fixed;
            top: 1rem;
            left: 1rem;
            z-index: 1100;
            background: var(--primary);
            color: white;
            border: none;
            width: 45px;
            height: 45px;
            border-radius: 10px;
            cursor: pointer;
        }

        @media (max-width: 992px) {
            .sidebar { transform: translateX(-100%); }
            .sidebar.show { transform: translateX(0); }
            .main-content { margin-left: 0; }
            .mobile-toggle { display: flex; align-items: center; justify-content: center; }
        }
    </style>
</head>
<body>
    <!-- Mobile Toggle -->
    <button class="mobile-toggle" onclick="toggleSidebar()">
        <i class="fas fa-bars"></i>
    </button>

    <!-- Left Sidebar -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <h4><a href="../../index.html"><i class="fas fa-shield-halved"></i> SOC Platform</a></h4>
            <p>Security Operations Center</p>
        </div>

        <nav class="nav-section">
            <div class="nav-section-title">Main Navigation</div>
            <a href="../../index.html" class="nav-item">
                <i class="fas fa-user-plus"></i> Registration
            </a>
            <a href="../../backend/dashboard.html" class="nav-item">
                <i class="fas fa-database"></i> Backend Dashboard
            </a>
        </nav>

        <nav class="nav-section">
            <div class="nav-section-title">Security Tools</div>
            
            <a href="#" class="nav-item active" onclick="toggleSubNav('hashSub', event)">
                <i class="fas fa-hashtag"></i> Hash Tools
                <i class="fas fa-chevron-down nav-toggle open" id="hashToggle"></i>
            </a>
            <div class="sub-nav show" id="hashSub">
                <a href="breach-checker/breach-checker.html" class="sub-nav-item">
                    <i class="fas fa-user-secret"></i> Password Breach Checker
                </a>
                <a href="algorithm-comparison/algorithm-comparison.html" class="sub-nav-item">
                    <i class="fas fa-balance-scale"></i> Algorithm Comparison
                </a>
                <a href="file-hash/file-hash.html" class="sub-nav-item">
                    <i class="fas fa-fingerprint"></i> Hash Generator
                </a>
                <a href="hash-verification/hash-verification.html" class="sub-nav-item">
                    <i class="fas fa-check-double"></i> Hash Verification
                </a>
            </div>

            <a href="../encryption/encryption.html" class="nav-item">
                <i class="fas fa-lock"></i> Encryption Tools
            </a>

            <a href="#" class="nav-item" onclick="toggleSubNav('utilitySub', event)">
                <i class="fas fa-tools"></i> Utility Tools
                <i class="fas fa-chevron-down nav-toggle" id="utilityToggle"></i>
            </a>
            <div class="sub-nav" id="utilitySub">
                <a href="../password-generator/password-generator.html" class="sub-nav-item">
                    <i class="fas fa-key"></i> Password Generator
                </a>
            </div>
        </nav>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <div class="top-bar">
            <div class="page-title">
                <i class="fas fa-hashtag" style="font-size: 1.5rem; color: var(--primary);"></i>
                <h2>Hash Analysis Tools</h2>
            </div>
            <span style="background: #d1fae5; color: #059669; padding: 0.5rem 1rem; border-radius: 50px; font-size: 0.8rem; font-weight: 600;">
                <i class="fas fa-shield-check"></i> Secure
            </span>
        </div>

        <div class="content-area">
            <!-- Tool Selector -->
            <div class="tool-selector">
                <label><i class="fas fa-tools me-2"></i>Select Tool:</label>
                <select id="toolSelect" onchange="showTool(this.value)">
                    <option value="comparison">üìä Hash Algorithm Comparison</option>
                    <option value="saltgen">üßÇ Salt Generator & Hasher</option>
                    <option value="filehash">üìÅ File Hash Calculator</option>
                    <option value="verify">‚úÖ Hash Verification</option>
                    <option value="breach">üîì Password Breach Checker</option>
                    <option value="identifier">üîç Hash Type Identifier</option>
                    <option value="entropy">üìà Password Entropy Analyzer</option>
                    <option value="rotation">üîÑ Password Rotation Detector</option>
                    <option value="all">üìã Show All Tools</option>
                </select>
            </div>

            <!-- Tool 1: Hash Comparison -->
            <div class="tool-card active" id="tool-comparison">
                <div class="tool-card-header">
                    <i class="fas fa-balance-scale" style="color: var(--primary);"></i>
                    <h3>Hash Algorithm Comparison</h3>
                </div>
                <div class="tool-card-body">
                    <div class="row">
                        <div class="col-md-4 mb-3">
                            <label class="form-label">Enter Password or Text</label>
                            <input type="text" class="form-control" id="comparisonPassword" placeholder="Type a password to hash...">
                        </div>
                        <div class="col-md-4 mb-3">
                            <label class="form-label"><i class="fas fa-salt-shaker"></i> Salt (Optional)</label>
                            <input type="text" class="form-control" id="comparisonSalt" placeholder="Add salt manually...">
                            <small class="text-muted">Salt is prepended to password before hashing</small>
                        </div>
                        <div class="col-md-4 mb-3">
                            <label class="form-label">Select Algorithms</label>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="checkMD5" checked>
                                <label for="checkMD5">MD5 (Insecure)</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="checkSHA1" checked>
                                <label for="checkSHA1">SHA-1 (Deprecated)</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="checkSHA256" checked>
                                <label for="checkSHA256">SHA-256 (Good)</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="checkSHA512">
                                <label for="checkSHA512">SHA-512 (Strong)</label>
                            </div>
                        </div>
                    </div>
                    <button class="btn btn-primary" onclick="compareHashes()">
                        <i class="fas fa-play"></i> Generate Hashes
                    </button>
                    <div class="results-area" id="comparisonResults"></div>
                </div>
            </div>

            <!-- Tool: Salt Generator & Hasher -->
            <div class="tool-card" id="tool-saltgen">
                <div class="tool-card-header">
                    <i class="fas fa-key" style="color: var(--success);"></i>
                    <h3>üßÇ Salt Generator & Secure Password Hasher</h3>
                </div>
                <div class="tool-card-body">
                    <div class="alert alert-info mb-3">
                        <i class="fas fa-info-circle me-2"></i>
                        <strong>About Salting:</strong> A salt is random data added to a password before hashing to prevent rainbow table attacks and ensure identical passwords produce different hashes.
                    </div>

                    <!-- Mode Toggle -->
                    <div class="mb-4 p-3" style="background: var(--bg-secondary); border-radius: 12px;">
                        <label class="form-label" style="font-weight: 700;"><i class="fas fa-cog"></i> Salt Mode</label>
                        <div class="d-flex gap-3 flex-wrap">
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="saltMode" id="modeManual" value="manual" checked onchange="toggleSaltMode()">
                                <label class="form-check-label" for="modeManual">
                                    <strong>Manual</strong> - Enter your own salt
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="saltMode" id="modeAuto" value="auto" onchange="toggleSaltMode()">
                                <label class="form-check-label" for="modeAuto">
                                    <strong>Automatic</strong> - Generate random salt
                                </label>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <!-- Password Input -->
                        <div class="col-md-6 mb-3">
                            <label class="form-label"><i class="fas fa-lock"></i> Password to Hash</label>
                            <input type="text" class="form-control" id="saltPassword" placeholder="Enter password...">
                        </div>

                        <!-- Manual Salt Input -->
                        <div class="col-md-6 mb-3" id="manualSaltArea">
                            <label class="form-label"><i class="fas fa-key"></i> Enter Salt Manually</label>
                            <input type="text" class="form-control" id="manualSalt" placeholder="Enter your custom salt...">
                            <small class="text-muted">Minimum 8 characters recommended</small>
                        </div>

                        <!-- Auto Salt Options -->
                        <div class="col-md-6 mb-3" id="autoSaltArea" style="display: none;">
                            <label class="form-label"><i class="fas fa-random"></i> Auto-Generate Salt</label>
                            <div class="d-flex gap-2 mb-2">
                                <select class="form-control" id="saltLength" style="width: auto;">
                                    <option value="8">8 chars</option>
                                    <option value="16" selected>16 chars</option>
                                    <option value="32">32 chars</option>
                                    <option value="64">64 chars</option>
                                </select>
                                <button class="btn btn-secondary" onclick="generateRandomSalt()" style="width: auto;">
                                    <i class="fas fa-dice"></i> Generate
                                </button>
                            </div>
                            <input type="text" class="form-control" id="autoSalt" placeholder="Generated salt will appear here..." readonly style="background: #f0fdf4; font-family: monospace;">
                        </div>
                    </div>

                    <!-- Hash Algorithm Selection -->
                    <div class="mb-3">
                        <label class="form-label"><i class="fas fa-hashtag"></i> Hash Algorithm</label>
                        <select class="form-control" id="saltHashAlgo" style="width: auto; display: inline-block;">
                            <option value="MD5">MD5</option>
                            <option value="SHA1">SHA-1</option>
                            <option value="SHA256" selected>SHA-256</option>
                            <option value="SHA512">SHA-512</option>
                        </select>
                    </div>

                    <!-- Salt Position -->
                    <div class="mb-3">
                        <label class="form-label"><i class="fas fa-arrows-alt-h"></i> Salt Position</label>
                        <div class="d-flex gap-3">
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="saltPosition" id="posPrepend" value="prepend" checked>
                                <label class="form-check-label" for="posPrepend">Prepend (salt + password)</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="saltPosition" id="posAppend" value="append">
                                <label class="form-check-label" for="posAppend">Append (password + salt)</label>
                            </div>
                        </div>
                    </div>

                    <button class="btn btn-success" onclick="generateSaltedHash()">
                        <i class="fas fa-shield-alt"></i> Generate Salted Hash
                    </button>

                    <div class="results-area" id="saltGenResults"></div>
                </div>
            </div>

            <!-- Tool: File Hash Calculator -->
            <div class="tool-card" id="tool-filehash">
                <div class="tool-card-header">
                    <i class="fas fa-file-alt" style="color: var(--primary);"></i>
                    <h3>üìÅ File Hash Calculator</h3>
                </div>
                <div class="tool-card-body">
                    <div class="alert alert-info mb-3">
                        <i class="fas fa-info-circle me-2"></i>
                        <strong>Real-World Use:</strong> Verify downloaded files match the publisher's checksum to detect tampering or corruption.
                    </div>

                    <div class="mb-3">
                        <label class="form-label"><i class="fas fa-upload"></i> Select File</label>
                        <input type="file" class="form-control" id="fileInput" onchange="calculateFileHash()">
                        <small class="text-muted">File is processed locally - never uploaded to any server</small>
                    </div>

                    <div class="mb-3">
                        <label class="form-label"><i class="fas fa-hashtag"></i> Algorithms to Calculate</label>
                        <div class="d-flex gap-3 flex-wrap">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="fileMD5" checked>
                                <label class="form-check-label" for="fileMD5">MD5</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="fileSHA1" checked>
                                <label class="form-check-label" for="fileSHA1">SHA-1</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="fileSHA256" checked>
                                <label class="form-check-label" for="fileSHA256">SHA-256</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="fileSHA512">
                                <label class="form-check-label" for="fileSHA512">SHA-512</label>
                            </div>
                        </div>
                    </div>

                    <div class="mb-3" style="background: var(--bg-secondary); padding: 1rem; border-radius: 8px;">
                        <label class="form-label"><i class="fas fa-check-circle"></i> Verify Against Known Hash (Optional)</label>
                        <input type="text" class="form-control" id="expectedHash" placeholder="Paste expected hash to compare...">
                    </div>

                    <div class="results-area" id="fileHashResults">
                        <p style="text-align: center; color: var(--text-muted); padding: 2rem;">
                            <i class="fas fa-cloud-upload-alt" style="font-size: 2rem; display: block; margin-bottom: 0.5rem;"></i>
                            Select a file to calculate its hash
                        </p>
                    </div>
                </div>
            </div>

            <!-- Tool: Hash Verification -->
            <div class="tool-card" id="tool-verify">
                <div class="tool-card-header">
                    <i class="fas fa-check-double" style="color: var(--success);"></i>
                    <h3>‚úÖ Hash Verification</h3>
                </div>
                <div class="tool-card-body">
                    <div class="alert alert-info mb-3">
                        <i class="fas fa-info-circle me-2"></i>
                        <strong>Real-World Use:</strong> Verify if a password matches a stored hash without knowing the original password.
                    </div>

                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label"><i class="fas fa-lock"></i> Password to Test</label>
                            <input type="text" class="form-control" id="verifyPassword" placeholder="Enter password to verify...">
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label"><i class="fas fa-key"></i> Salt (if salted)</label>
                            <input type="text" class="form-control" id="verifySalt" placeholder="Enter salt (leave empty if none)...">
                        </div>
                    </div>

                    <div class="mb-3">
                        <label class="form-label"><i class="fas fa-hashtag"></i> Hash to Match Against</label>
                        <textarea class="form-control" id="verifyHash" rows="2" placeholder="Paste the hash you want to verify against..."></textarea>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">Algorithm</label>
                        <select class="form-control" id="verifyAlgorithm" style="width: auto; display: inline-block;">
                            <option value="MD5">MD5</option>
                            <option value="SHA1">SHA-1</option>
                            <option value="SHA256" selected>SHA-256</option>
                            <option value="SHA512">SHA-512</option>
                        </select>
                    </div>

                    <button class="btn btn-success" onclick="verifyHash()">
                        <i class="fas fa-check"></i> Verify Hash
                    </button>

                    <div class="results-area" id="verifyResults"></div>
                </div>
            </div>

            <!-- Tool: Password Breach Checker -->
            <div class="tool-card" id="tool-breach">
                <div class="tool-card-header">
                    <i class="fas fa-user-secret" style="color: var(--danger);"></i>
                    <h3>üîì Password Breach Checker - HIBP Integration</h3>
                </div>
                <div class="tool-card-body">
                    <div class="alert alert-info mb-3">
                        <h5><i class="fas fa-shield-alt"></i> Privacy-First Design</h5>
                        <p style="margin-bottom: 0.5rem;"><strong>k-Anonymity Model:</strong> Your password is NEVER sent over the network!</p>
                        <ul style="margin: 0; padding-left: 1.5rem; font-size: 0.9rem;">
                            <li>Password hashed locally with SHA-1</li>
                            <li>Only first 5 characters of hash sent to API</li>
                            <li>Checked against 600M+ breached passwords</li>
                            <li>Results verified locally on your device</li>
                        </ul>
                    </div>

                    <div class="mb-3 breach-checker-input">
                        <label class="form-label"><i class="fas fa-lock"></i> Enter Password to Check</label>
                        <input type="password" class="form-control" id="breachPassword" placeholder="Type or paste password here..." style="font-size: 1.1rem; padding: 0.75rem;">
                        <small class="text-muted">Checks against Have I Been Pwned (Troy Hunt) - 12+ billion breached credentials</small>
                    </div>

                    <div class="breach-checker-actions">
                        <button class="btn btn-danger btn-lg" onclick="checkPasswordBreach()" style="padding: 0.75rem 2rem;">
                            <i class="fas fa-search"></i> Check Password Security
                        </button>
                        <button class="btn btn-success btn-lg" onclick="generateSecurePassword()" style="padding: 0.75rem 2rem;">
                            <i class="fas fa-random"></i> Generate Secure Password
                        </button>
                    </div>

                    <div class="breach-result" id="breachResult"></div>

                    <div class="mt-4 p-3" style="background: linear-gradient(135deg, #eff6ff 0%, #f3f4f6 100%); border-radius: 12px; border-left: 4px solid var(--primary);">
                        <h6 style="margin-bottom: 0.75rem;"><i class="fas fa-info-circle"></i> How k-Anonymity Protects You:</h6>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; font-size: 0.875rem;">
                            <div>
                                <strong>1Ô∏è‚É£ Local Hashing</strong><br>
                                <span style="color: var(--text-muted);">SHA-1 computed on your device</span>
                            </div>
                            <div>
                                <strong>2Ô∏è‚É£ Partial Match</strong><br>
                                <span style="color: var(--text-muted);">Only 5 chars sent to server</span>
                            </div>
                            <div>
                                <strong>3Ô∏è‚É£ Bulk Response</strong><br>
                                <span style="color: var(--text-muted);">Server returns ~500 hashes</span>
                            </div>
                            <div>
                                <strong>4Ô∏è‚É£ Local Verify</strong><br>
                                <span style="color: var(--text-muted);">Match checked on your device</span>
                            </div>
                        </div>
                    </div>
                    </button>

                    <div class="results-area" id="breachResults"></div>
                </div>
            </div>

            <!-- Tool 2: Hash Identifier -->
            <div class="tool-card" id="tool-identifier">
                <div class="tool-card-header">
                    <i class="fas fa-search" style="color: var(--success);"></i>
                    <h3>Hash Type Identifier</h3>
                </div>
                <div class="tool-card-body">
                    <label class="form-label">Paste Hash String</label>
                    <textarea class="form-control mb-3" id="hashInput" rows="3" placeholder="Paste any hash here to identify its type..."></textarea>
                    <button class="btn btn-success" onclick="identifyHash()">
                        <i class="fas fa-search"></i> Identify Hash Type
                    </button>
                    <div class="results-area" id="identificationResults"></div>
                </div>
            </div>

            <!-- Tool 3: Entropy Analyzer -->
            <div class="tool-card" id="tool-entropy">
                <div class="tool-card-header">
                    <i class="fas fa-chart-bar" style="color: var(--warning);"></i>
                    <h3>Password Entropy Analyzer</h3>
                </div>
                <div class="tool-card-body">
                    <label class="form-label">Enter Password to Analyze</label>
                    <input type="text" class="form-control mb-3" id="entropyPassword" placeholder="Type a password to analyze its strength...">
                    <button class="btn btn-warning" onclick="analyzeEntropy()">
                        <i class="fas fa-calculator"></i> Calculate Entropy
                    </button>
                    <div class="results-area" id="entropyResults"></div>
                </div>
            </div>

            <!-- Tool 4: Rotation Detector -->
            <div class="tool-card" id="tool-rotation">
                <div class="tool-card-header">
                    <i class="fas fa-sync-alt" style="color: var(--accent);"></i>
                    <h3>Password Rotation Pattern Detector</h3>
                </div>
                <div class="tool-card-body">
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle me-2"></i>
                        <strong>Educational:</strong> This demonstrates why forced password rotation often leads to predictable patterns.
                    </div>
                    <label class="form-label">Enter Password Sequence (one per line)</label>
                    <textarea class="form-control mb-3" id="passwordSequence" rows="5" placeholder="Password1&#10;Password2&#10;Password3&#10;..."></textarea>
                    <button class="btn btn-primary" onclick="analyzeRotation()">
                        <i class="fas fa-search"></i> Detect Patterns
                    </button>
                    <div class="results-area" id="rotationResults"></div>
                </div>
            </div>
        </div>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <script>
        // Toggle sidebar for mobile
        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('show');
        }

        // Toggle sub-navigation
        function toggleSubNav(id, event) {
            event.preventDefault();
            event.stopPropagation();
            const subNav = document.getElementById(id);
            const allSubNavs = document.querySelectorAll('.sub-nav');
            const toggle = event.currentTarget.querySelector('.nav-toggle');
            
            allSubNavs.forEach(nav => {
                if (nav.id !== id) {
                    nav.classList.remove('show');
                    nav.previousElementSibling.querySelector('.nav-toggle')?.classList.remove('open');
                }
            });
            
            subNav.classList.toggle('show');
            toggle?.classList.toggle('open');
        }

        // Tool Selector
        function showTool(toolId) {
            const cards = document.querySelectorAll('.tool-card');
            cards.forEach(card => {
                if (toolId === 'all') {
                    card.classList.add('active');
                } else if (card.id === 'tool-' + toolId) {
                    card.classList.add('active');
                } else {
                    card.classList.remove('active');
                }
            });
            document.getElementById('toolSelect').value = toolId;
        }

        // Hash Comparison
        function compareHashes() {
            const password = document.getElementById('comparisonPassword').value;
            if (!password) { alert('Please enter a password'); return; }

            let html = '<table class="table"><thead><tr><th>Algorithm</th><th>Salt</th><th>Hash Output</th><th>Length</th><th>Security</th></tr></thead><tbody>';

            const salt = document.getElementById('comparisonSalt').value;
            const saltedPassword = salt + password;
            const saltDisplay = salt ? `<code style="color: #fbbf24;">${salt}</code>` : '<span style="color: #94a3b8;">None</span>';

            if (document.getElementById('checkMD5').checked) {
                const md5 = CryptoJS.MD5(saltedPassword).toString();
                html += `<tr><td><span class="badge badge-danger">MD5</span></td><td>${saltDisplay}</td><td><code>${md5}</code></td><td>32 chars</td><td>‚ùå Insecure</td></tr>`;
            }
            if (document.getElementById('checkSHA1').checked) {
                const sha1 = CryptoJS.SHA1(saltedPassword).toString();
                html += `<tr><td><span class="badge badge-warning">SHA-1</span></td><td>${saltDisplay}</td><td><code>${sha1}</code></td><td>40 chars</td><td>‚ö†Ô∏è Deprecated</td></tr>`;
            }
            if (document.getElementById('checkSHA256').checked) {
                const sha256 = CryptoJS.SHA256(saltedPassword).toString();
                html += `<tr><td><span class="badge badge-info">SHA-256</span></td><td>${saltDisplay}</td><td><code>${sha256}</code></td><td>64 chars</td><td>‚úÖ Good</td></tr>`;
            }
            if (document.getElementById('checkSHA512').checked) {
                const sha512 = CryptoJS.SHA512(saltedPassword).toString();
                html += `<tr><td><span class="badge badge-success">SHA-512</span></td><td>${saltDisplay}</td><td><code>${sha512}</code></td><td>128 chars</td><td>‚úÖ Strong</td></tr>`;
            }

            html += '</tbody></table>';
            document.getElementById('comparisonResults').innerHTML = html;
        }

        // Hash Identifier
        function identifyHash() {
            const hash = document.getElementById('hashInput').value.trim();
            if (!hash) { alert('Please enter a hash'); return; }

            const len = hash.length;
            let type = 'Unknown', info = '', security = '';

            if (len === 32 && /^[a-f0-9]+$/i.test(hash)) {
                type = 'MD5'; info = 'Fast, vulnerable to collisions'; security = 'badge-danger';
            } else if (len === 40 && /^[a-f0-9]+$/i.test(hash)) {
                type = 'SHA-1'; info = 'Known vulnerabilities'; security = 'badge-warning';
            } else if (len === 64 && /^[a-f0-9]+$/i.test(hash)) {
                type = 'SHA-256'; info = 'Suitable for integrity checks'; security = 'badge-info';
            } else if (len === 128 && /^[a-f0-9]+$/i.test(hash)) {
                type = 'SHA-512'; info = 'Strong cryptographic hash'; security = 'badge-success';
            } else if (hash.startsWith('$2') && len === 60) {
                type = 'BCrypt'; info = 'Password hashing with salt'; security = 'badge-success';
            } else if (hash.startsWith('$argon2')) {
                type = 'Argon2'; info = 'Memory-hard algorithm'; security = 'badge-success';
            }

            document.getElementById('identificationResults').innerHTML = `
                <div class="alert alert-info">
                    <h5><i class="fas fa-info-circle"></i> Detection Result</h5>
                    <p><strong>Hash Type:</strong> <span class="badge ${security}">${type}</span><br>
                    <strong>Length:</strong> ${len} characters<br>
                    <strong>Assessment:</strong> ${info}</p>
                </div>`;
        }

        // Entropy Analyzer
        function analyzeEntropy() {
            const password = document.getElementById('entropyPassword').value;
            if (!password) { alert('Please enter a password'); return; }

            let charset = 0;
            if (/[a-z]/.test(password)) charset += 26;
            if (/[A-Z]/.test(password)) charset += 26;
            if (/[0-9]/.test(password)) charset += 10;
            if (/[^a-zA-Z0-9]/.test(password)) charset += 32;

            const entropy = Math.log2(Math.pow(charset, password.length));
            const strength = entropy < 28 ? 'Very Weak' : entropy < 36 ? 'Weak' : entropy < 60 ? 'Medium' : entropy < 128 ? 'Strong' : 'Very Strong';
            const color = entropy < 28 ? 'danger' : entropy < 36 ? 'warning' : entropy < 60 ? 'info' : 'success';

            document.getElementById('entropyResults').innerHTML = `
                <div class="alert alert-${color}">
                    <h5><i class="fas fa-chart-line"></i> Entropy Analysis</h5>
                    <p><strong>Password Length:</strong> ${password.length} characters<br>
                    <strong>Character Set Size:</strong> ${charset}<br>
                    <strong>Entropy:</strong> ${entropy.toFixed(2)} bits<br>
                    <strong>Strength:</strong> ${strength}</p>
                    <div class="progress">
                        <div class="progress-bar bg-${color}" style="width: ${Math.min(100, entropy/1.28)}%">${entropy.toFixed(1)} bits</div>
                    </div>
                </div>`;
        }

        // Rotation Analyzer
        function analyzeRotation() {
            const sequence = document.getElementById('passwordSequence').value.trim();
            if (!sequence) { alert('Please enter password sequence'); return; }

            const passwords = sequence.split('\n').filter(p => p.trim());
            if (passwords.length < 2) { alert('Please enter at least 2 passwords'); return; }

            let patterns = [];
            let riskScore = 0;

            let hasSequentialNumbers = false;
            for (let i = 1; i < passwords.length; i++) {
                const prevNum = passwords[i-1].match(/\d+/);
                const currNum = passwords[i].match(/\d+/);
                if (prevNum && currNum && parseInt(currNum[0]) === parseInt(prevNum[0]) + 1) {
                    hasSequentialNumbers = true;
                    riskScore += 20;
                }
            }
            if (hasSequentialNumbers) {
                patterns.push('<span style="color: var(--danger);">‚úó Sequential numbers detected</span>');
            }

            const bases = passwords.map(p => p.replace(/\d+$/, ''));
            if (bases.every(b => b === bases[0]) && bases[0]) {
                patterns.push('<span style="color: var(--danger);">‚úó Same base word with number changes</span>');
                riskScore += 30;
            }

            if (passwords.some(p => /spring|summer|fall|winter|202\d/i.test(p))) {
                patterns.push('<span style="color: var(--warning);">‚ö† Season or year patterns detected</span>');
                riskScore += 15;
            }

            let riskColor = riskScore < 30 ? 'success' : riskScore < 50 ? 'warning' : 'danger';
            let riskText = riskScore < 30 ? 'Low Risk' : riskScore < 50 ? 'Medium Risk' : 'High Risk';

            document.getElementById('rotationResults').innerHTML = `
                <div class="alert alert-${riskColor}">
                    <h5>Pattern Analysis Complete</h5>
                    <p><strong>Risk Score:</strong> <span class="badge badge-${riskColor}">${riskText} (${riskScore}/100)</span></p>
                    <div class="progress mb-3">
                        <div class="progress-bar bg-${riskColor}" style="width: ${riskScore}%">${riskScore}%</div>
                    </div>
                    <h6>Detected Patterns:</h6>
                    ${patterns.length > 0 ? '<ul>' + patterns.map(p => '<li>' + p + '</li>').join('') + '</ul>' : '<p style="color: var(--success);">‚úì No obvious patterns detected</p>'}
                    <div class="alert alert-info" style="margin-top: 1rem;">
                        <strong>üí° Tip:</strong> Use a password manager to generate and store unique, random passwords.
                    </div>
                </div>`;
        }

        // Salt Generator Functions
        function toggleSaltMode() {
            const isManual = document.getElementById('modeManual').checked;
            document.getElementById('manualSaltArea').style.display = isManual ? 'block' : 'none';
            document.getElementById('autoSaltArea').style.display = isManual ? 'none' : 'block';
        }

        function generateRandomSalt() {
            const length = parseInt(document.getElementById('saltLength').value);
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*()_+-=[]{}|;:,.<>?';
            let salt = '';
            const array = new Uint32Array(length);
            crypto.getRandomValues(array);
            for (let i = 0; i < length; i++) {
                salt += chars[array[i] % chars.length];
            }
            document.getElementById('autoSalt').value = salt;
            return salt;
        }

        function getCurrentSalt() {
            const isManual = document.getElementById('modeManual').checked;
            if (isManual) {
                return document.getElementById('manualSalt').value;
            } else {
                return document.getElementById('autoSalt').value;
            }
        }

        function generateSaltedHash() {
            const password = document.getElementById('saltPassword').value;
            const salt = getCurrentSalt();
            const algo = document.getElementById('saltHashAlgo').value;
            const prepend = document.getElementById('posPrepend').checked;

            if (!password) { alert('Please enter a password'); return; }
            if (!salt) { alert('Please enter or generate a salt'); return; }

            const saltedPassword = prepend ? (salt + password) : (password + salt);
            let hash = '';
            
            switch(algo) {
                case 'MD5':
                    hash = CryptoJS.MD5(saltedPassword).toString();
                    break;
                case 'SHA1':
                    hash = CryptoJS.SHA1(saltedPassword).toString();
                    break;
                case 'SHA256':
                    hash = CryptoJS.SHA256(saltedPassword).toString();
                    break;
                case 'SHA512':
                    hash = CryptoJS.SHA512(saltedPassword).toString();
                    break;
            }

            const saltWarning = salt.length < 8 ? '<span style="color: var(--warning);">‚ö†Ô∏è Salt is short (< 8 chars). Longer salts are more secure.</span>' : '<span style="color: var(--success);">‚úÖ Salt length is adequate.</span>';

            document.getElementById('saltGenResults').innerHTML = `
                <div class="alert alert-success">
                    <h5><i class="fas fa-shield-alt"></i> Salted Hash Generated</h5>
                    <table class="table" style="margin-top: 1rem;">
                        <tbody>
                            <tr><td style="width: 140px;"><strong>Password:</strong></td><td><code>${password}</code></td></tr>
                            <tr><td><strong>Salt:</strong></td><td><code style="color: var(--warning);">${salt}</code> (${salt.length} chars)</td></tr>
                            <tr><td><strong>Position:</strong></td><td>${prepend ? 'Prepend (salt + password)' : 'Append (password + salt)'}</td></tr>
                            <tr><td><strong>Combined:</strong></td><td><code>${saltedPassword}</code></td></tr>
                            <tr><td><strong>Algorithm:</strong></td><td><span class="badge badge-info">${algo}</span></td></tr>
                            <tr><td><strong>Salted Hash:</strong></td><td><code style="word-break: break-all; color: var(--success);">${hash}</code></td></tr>
                        </tbody>
                    </table>
                    <div style="margin-top: 1rem; padding: 0.75rem; background: var(--bg-secondary); border-radius: 8px;">
                        ${saltWarning}<br>
                        <small class="text-muted">üí° Store the salt separately from the hash. Both are needed to verify passwords.</small>
                    </div>
                </div>
            `;
        }

        // ============================================
        // FILE HASH CALCULATOR
        // ============================================
        async function calculateFileHash() {
            const fileInput = document.getElementById('fileInput');
            const file = fileInput.files[0];
            
            if (!file) return;

            const resultsDiv = document.getElementById('fileHashResults');
            resultsDiv.innerHTML = `
                <div style="text-align: center; padding: 2rem;">
                    <div class="spinner-border text-primary" role="status"></div>
                    <p style="margin-top: 1rem;">Calculating hashes for <strong>${file.name}</strong>...</p>
                    <p style="font-size: 0.8rem; color: var(--text-muted);">File size: ${formatFileSize(file.size)}</p>
                </div>
            `;

            try {
                const arrayBuffer = await file.arrayBuffer();
                const wordArray = CryptoJS.lib.WordArray.create(arrayBuffer);
                
                const hashes = {};
                if (document.getElementById('fileMD5').checked) {
                    hashes.MD5 = CryptoJS.MD5(wordArray).toString();
                }
                if (document.getElementById('fileSHA1').checked) {
                    hashes.SHA1 = CryptoJS.SHA1(wordArray).toString();
                }
                if (document.getElementById('fileSHA256').checked) {
                    hashes.SHA256 = CryptoJS.SHA256(wordArray).toString();
                }
                if (document.getElementById('fileSHA512').checked) {
                    hashes.SHA512 = CryptoJS.SHA512(wordArray).toString();
                }

                const expectedHash = document.getElementById('expectedHash').value.trim().toLowerCase();
                let verificationResult = '';
                
                if (expectedHash) {
                    const matchFound = Object.values(hashes).some(h => h.toLowerCase() === expectedHash);
                    verificationResult = matchFound 
                        ? '<div class="alert alert-success"><i class="fas fa-check-circle"></i> <strong>MATCH!</strong> File integrity verified successfully.</div>'
                        : '<div class="alert alert-danger"><i class="fas fa-times-circle"></i> <strong>NO MATCH!</strong> File may be corrupted or tampered with.</div>';
                }

                let tableRows = '';
                for (const [algo, hash] of Object.entries(hashes)) {
                    const isMatch = expectedHash && hash.toLowerCase() === expectedHash;
                    tableRows += `
                        <tr>
                            <td><span class="badge badge-${algo === 'MD5' ? 'danger' : algo === 'SHA1' ? 'warning' : 'success'}">${algo}</span></td>
                            <td>
                                <code style="word-break: break-all; ${isMatch ? 'color: var(--success); font-weight: bold;' : ''}">${hash}</code>
                                ${isMatch ? ' <i class="fas fa-check text-success"></i>' : ''}
                                <button class="btn btn-sm btn-outline-secondary ms-2" onclick="copyToClipboard('${hash}')">
                                    <i class="fas fa-copy"></i>
                                </button>
                            </td>
                        </tr>
                    `;
                }

                resultsDiv.innerHTML = `
                    <div class="alert alert-info">
                        <h5><i class="fas fa-file"></i> ${file.name}</h5>
                        <p style="margin: 0;"><strong>Size:</strong> ${formatFileSize(file.size)} | <strong>Type:</strong> ${file.type || 'Unknown'}</p>
                    </div>
                    ${verificationResult}
                    <table class="table">
                        <thead><tr><th>Algorithm</th><th>Hash Value</th></tr></thead>
                        <tbody>${tableRows}</tbody>
                    </table>
                `;
            } catch (error) {
                resultsDiv.innerHTML = `<div class="alert alert-danger"><i class="fas fa-exclamation-triangle"></i> Error: ${error.message}</div>`;
            }
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                alert('Copied to clipboard!');
            });
        }

        // ============================================
        // HASH VERIFICATION
        // ============================================
        function verifyHash() {
            const password = document.getElementById('verifyPassword').value;
            const salt = document.getElementById('verifySalt').value;
            const targetHash = document.getElementById('verifyHash').value.trim().toLowerCase();
            const algo = document.getElementById('verifyAlgorithm').value;

            if (!password) { alert('Please enter a password'); return; }
            if (!targetHash) { alert('Please enter a hash to verify against'); return; }

            const saltedPassword = salt + password;
            let computedHash = '';
            
            switch(algo) {
                case 'MD5':
                    computedHash = CryptoJS.MD5(saltedPassword).toString();
                    break;
                case 'SHA1':
                    computedHash = CryptoJS.SHA1(saltedPassword).toString();
                    break;
                case 'SHA256':
                    computedHash = CryptoJS.SHA256(saltedPassword).toString();
                    break;
                case 'SHA512':
                    computedHash = CryptoJS.SHA512(saltedPassword).toString();
                    break;
            }

            const isMatch = computedHash.toLowerCase() === targetHash.toLowerCase();

            document.getElementById('verifyResults').innerHTML = `
                <div class="alert alert-${isMatch ? 'success' : 'danger'}">
                    <h4>
                        <i class="fas fa-${isMatch ? 'check-circle' : 'times-circle'}"></i>
                        ${isMatch ? 'PASSWORD MATCHES!' : 'PASSWORD DOES NOT MATCH'}
                    </h4>
                    <table class="table" style="margin-top: 1rem;">
                        <tbody>
                            <tr><td><strong>Password:</strong></td><td><code>${password}</code></td></tr>
                            ${salt ? `<tr><td><strong>Salt:</strong></td><td><code style="color: var(--warning);">${salt}</code></td></tr>` : ''}
                            <tr><td><strong>Algorithm:</strong></td><td><span class="badge badge-info">${algo}</span></td></tr>
                            <tr><td><strong>Computed Hash:</strong></td><td><code style="word-break: break-all;">${computedHash}</code></td></tr>
                            <tr><td><strong>Target Hash:</strong></td><td><code style="word-break: break-all;">${targetHash}</code></td></tr>
                        </tbody>
                    </table>
                </div>
            `;
        }

        // ============================================
        // PASSWORD BREACH CHECKER (Have I Been Pwned API)
        // ============================================
        function toggleBreachPassword() {
            const input = document.getElementById('breachPassword');
            const icon = document.getElementById('breachEyeIcon');
            if (input.type === 'password') {
                input.type = 'text';
                icon.classList.remove('fa-eye');
                icon.classList.add('fa-eye-slash');
            } else {
                input.type = 'password';
                icon.classList.remove('fa-eye-slash');
                icon.classList.add('fa-eye');
            }
        }

        async function checkBreach() {
            const password = document.getElementById('breachPassword').value;
            if (!password) { alert('Please enter a password to check'); return; }
            
            await checkPasswordBreach(password);
        }

        async function demonstrateBreach() {
            document.getElementById('breachPassword').value = 'password123';
            await checkPasswordBreach('password123');
        }

        async function checkPasswordBreach(password) {
            const resultsDiv = document.getElementById('breachResults');
            resultsDiv.innerHTML = `
                <div style="text-align: center; padding: 2rem;">
                    <div class="spinner-border text-danger" role="status"></div>
                    <p style="margin-top: 1rem;">Checking breach databases...</p>
                </div>
            `;

            try {
                // Calculate SHA-1 hash
                const sha1Hash = CryptoJS.SHA1(password).toString().toUpperCase();
                const prefix = sha1Hash.substring(0, 5);
                const suffix = sha1Hash.substring(5);

                // Query Have I Been Pwned API with k-anonymity
                const response = await fetch(`https://api.pwnedpasswords.com/range/${prefix}`);
                
                if (!response.ok) {
                    throw new Error('API request failed');
                }

                const text = await response.text();
                const hashes = text.split('\r\n');
                
                let breachCount = 0;
                for (const line of hashes) {
                    const [hashSuffix, count] = line.split(':');
                    if (hashSuffix === suffix) {
                        breachCount = parseInt(count);
                        break;
                    }
                }

                if (breachCount > 0) {
                    resultsDiv.innerHTML = `
                        <div class="alert alert-danger">
                            <h4><i class="fas fa-exclamation-triangle"></i> PASSWORD COMPROMISED!</h4>
                            <p style="font-size: 1.25rem;">This password has been found in <strong style="color: var(--danger);">${breachCount.toLocaleString()}</strong> data breaches.</p>
                            <hr>
                            <p><strong>Recommendation:</strong> Do NOT use this password. If you're using it anywhere:</p>
                            <ul>
                                <li>Change it immediately</li>
                                <li>Use a unique, randomly generated password</li>
                                <li>Enable two-factor authentication</li>
                                <li>Consider using a password manager</li>
                            </ul>
                        </div>
                        <div class="alert alert-secondary">
                            <small><strong>Technical Details:</strong><br>
                            SHA-1 Hash: <code>${sha1Hash}</code><br>
                            API Query: <code>${prefix}...</code> (k-anonymity preserved)</small>
                        </div>
                    `;
                } else {
                    resultsDiv.innerHTML = `
                        <div class="alert alert-success">
                            <h4><i class="fas fa-check-circle"></i> NO BREACHES FOUND</h4>
                            <p>This password was not found in any known data breaches.</p>
                            <hr>
                            <p><small><strong>Note:</strong> This doesn't guarantee the password is secure - it just hasn't appeared in known breaches. Always use strong, unique passwords.</small></p>
                        </div>
                        <div class="alert alert-secondary">
                            <small><strong>Technical Details:</strong><br>
                            SHA-1 Hash: <code>${sha1Hash}</code><br>
                            Checked against: 12+ billion breached passwords</small>
                        </div>
                    `;
                }
            } catch (error) {
                resultsDiv.innerHTML = `
                    <div class="alert alert-warning">
                        <h5><i class="fas fa-exclamation-circle"></i> Could not check breach database</h5>
                        <p>Error: ${error.message}</p>
                        <p><small>This might be due to network issues or CORS restrictions. The Have I Been Pwned API may need to be accessed from a server.</small></p>
                    </div>
                `;
            }
        }
    </script>
</body>
</html>
